
## Курс “DEVSYS-PDC-2 DevOps-инженер”. Кожаев Л.С.
### ДЗ. 05-virt-01-basics. 5.1. Введение в виртуализацию. Типы и функции гипервизоров. Обзор рынка вендоров и областей применения.
---

## Задача 1

Опишите кратко, как вы поняли: в чем основное отличие полной (аппаратной) виртуализации, паравиртуализации и виртуализации на основе ОС.

### Ответ:
| Полная виртуализация | Паравиртуализация| Виртуализации на основе ОС | 
| ------------- | ------------- | ------------- |
| Гипервизор установлен как самостоятельная и основная ("материнская") ОС на физическом оборудовании  | Гипервизор устанавливается в ввиде отдельного ПО, на работающую ОС хоста (на материнскую ОС сервера) или работает в ввиде готовой сборки ОС+гипервизор+инструменты управления | Как такового гипервизора нет, используется ПО для управления контейнерами - своего рода изолированными копиями хостовой ОС.|
| Ядро гостевых систем не меняется  | Ядро гостевых систем модифицируется | Используется то же самое ядро, что и у хост-системы |

## Задача 2

Выберите один из вариантов использования организации физических серверов, в зависимости от условий использования.

Организация серверов:
- физические сервера,
- паравиртуализация,
- виртуализация уровня ОС.

Условия использования:
- Высоконагруженная база данных, чувствительная к отказу.
- Различные web-приложения.
- Windows системы для использования бухгалтерским отделом.
- Системы, выполняющие высокопроизводительные расчеты на GPU.

Опишите, почему вы выбрали к каждому целевому использованию такую организацию.

### Ответ:
| Высоконагруженная база данных | Различные web-приложения| Windows системы для использования бухгалтерским отделом | Системы, выполняющие высокопроизводительные расчеты на GPU |
| ------------- | ------------- | ------------- |  ------------- |
| Физические серверы. В связи с интенсивностью выполнения операций ввода-вывода, требованиями к скорости работы дисковой подсистемы и специализацией сервера под СУБД | Виртуализация уровня ОС. Возможность запустить множество web_приложений на одном физическом сервере и под управлением одной ОС, эффективно используя доступные ресурсы. | Паравиртуализация или нативная/полная виртуализация. Например, нужно 3 сервера для 1С (терминальный для пользователей, сервер приложений и сервер с СУБД), эффективнее запустить это всё в виртуальной среде, для удобного и быстрого разворачивания, управления, резервного копирования, переноса на другой сервер в случае проблем и тд.  | Возможна как GPU-виртуализация, так и физические серверы, зависит от параметров сервера, видеокарт и конкретных задач, выделяемых средств и тд. Если команда работает, например, над созданием сложной  графики, проектированием, рендерингом и есть возможности/ресурсы, то GPU-виртуализация. |


## Задача 3

Выберите подходящую систему управления виртуализацией для предложенного сценария. Детально опишите ваш выбор.

Сценарии:

1. 100 виртуальных машин на базе Linux и Windows, общие задачи, нет особых требований. Преимущественно Windows based инфраструктура, требуется реализация программных балансировщиков нагрузки, репликации данных и автоматизированного механизма создания резервных копий.
2. Требуется наиболее производительное бесплатное open source решение для виртуализации небольшой (20-30 серверов) инфраструктуры на базе Linux и Windows виртуальных машин.
3. Необходимо бесплатное, максимально совместимое и производительное решение для виртуализации Windows инфраструктуры.
4. Необходимо рабочее окружение для тестирования программного продукта на нескольких дистрибутивах Linux.

### Ответ:

1. Зависит от выделяемых средств и планах масштабироваться, это может быть как облачное решение, так и Hyper-V Server, которым проще (удобнее/понятнее, если специалисты в основном работают с Windows системами) будет управлять и есть требуемый функционал. Если бюджет позволяет и есть спецы, то можно и VMware vSphere c vCenter Server, там вполне уживаются, как Linux, так и Windows. 
2. Возможно решение на базе kvm, например Proxmox. Или VMware ESXi (если нет требований по выделяемому кол-ву ядер). Наибольшая производительность будет зависеть не только от платного/бесплатного решения, например будет существенная разница в системе на старых HDD, старом процессоре и с памятью ddr2 или 3 ( ну чтоб года до 2010 взять сервера, куда могут захотеть "наибольшую производительность" :)) ) и в решениях на хорошем схд с nvme/ssd и правильной архитектурой системы без узких мест по потерям производительности в целом. 
3. Если нет проблем с лицензированием, то Hyper-V Server или Windows Server и отдельно роль Hyper-V. 
4. Если для одного человека и на своём рабочем хосте, то VirtualBox и Vagrant, например. Если команда, то наверное KVM (Proxmox, например) или VMware ESXi если есть подходящее под него, совместимое железо. 

PS. C Xen, Citrix - не сталкивался пока, может для 2-го и 4-го пункта тоже можно использовать, как наиболее стабильное работающее решение и если есть специалисты которые могут грамотно его развернуть и допилить. 

## Задача 4

Опишите возможные проблемы и недостатки гетерогенной среды виртуализации (использования нескольких систем управления виртуализацией одновременно) и что необходимо сделать для минимизации этих рисков и проблем. Если бы у вас был выбор, то создавали бы вы гетерогенную среду или нет? Мотивируйте ваш ответ примерами.

### Ответ:

Очевидно, что такую систему сложнее администрировать и поддерживать на должном уровне. Если специалистов много и нельзя унифицировать, то почему бы и нет. Например, сервер с Hyper-V и 5 гостевых ОС с Windows и сервер ESXi c 10 OS Linux, и несколько физических серверов, например с БД и один из DC (AD), если это всё функционирует , то ломать и пробовать перейти на неизвестный (тем кто будет с ним работать) гипервизор или покупать за 100500 млн. новые сервера для унификации, думаю не очень идея. 

Пример2. Если нет достаточного кол-ва спецов и ещё постоянная текучка кадров, то разное оборудование + разные гипервизоры и системы управления (особенно настроенные "кем-то другим" без документирования) создадут проблемы, как в плане простого обеспечения и закупок комплектующих/оплате лицензий и тд., так в управлении, обновлении этих систем, проблем с безопасностью (чем сложнее система, тем больше можно найти уязвимых мест и тем сложнее контролировать и анализировать эти уязвимые места), также и про отказоустойчивость и совместимость - отдельная головная боль, при зоопарке из различных сервисов, серверов и разных систем управления.   

Если есть конкретные условия, задачи, бюджет и можно использовать единую среду, то конечно лучше единая. Проще решать проблемы с модернизацией, заменой оборудования, обновлением системы, поисками решения проблем и обеспечением безопасности. Ну и можно сконцентрироваться на одной системе, которую хорошо знаешь. Вопрос в том, чтобы изначально спроектировано было с учетом масштабов и закрытием всех требований с запасом.  
