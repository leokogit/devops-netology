## Домашние задания по курсу “DEVSYS-PDC-2 DevOps-инженер”. Кожаев Л.С.
### ДЗ. 03-sysadmin-07-net. 3.7. Компьютерные сети, лекция 2

#### 1. Проверьте список доступных сетевых интерфейсов на вашем компьютере. Какие команды есть для этого в Linux и в Windows?

Ответ:
```
vagrant@vagrant:~$ ip -br l
lo               UNKNOWN        00:00:00:00:00:00 <LOOPBACK,UP,LOWER_UP>
eth0             UP             08:00:27:73:60:cf <BROADCAST,MULTICAST,UP,LOWER_UP>

В Windows :

netsh interface ipv4 show interfaces

```
---

#### 2. Какой протокол используется для распознавания соседа по сетевому интерфейсу? Какой пакет и команды есть в Linux для этого?  

Ответ:  
Протокол LLDP   
Пакет lldpd (служба/демон)    
Команда:    
`$ sudo lldpctl`        Посмотреть соседние устройства    

---

#### 3. Какая технология используется для разделения L2 коммутатора на несколько виртуальных сетей? Какой пакет и команды есть в Linux для этого? Приведите пример конфига.

Ответ:    

Технология VLAN   

```
$ sudo ip link add link eth0 name eth0.10 type vlan id 10   
$ sudo ip link set up eth0.10   
$ ip -br a    
lo               UNKNOWN        127.0.0.1/8 ::1/128
eth0             UP             10.0.2.15/24 fe80::a00:27ff:fe73:60cf/64
eth0.10@eth0     UP             fe80::a00:27ff:fe73:60cf/64

```
Пример конфигурации:    

```
network:
  version: 2
  ethernets:
    eth0:
      dhcp4: true
  vlans:
        vlan10:
            id: 10
            link: eth0
            dhcp4: no
            addresses: [10.0.0.15/24]
            gateway4: 10.0.0.1
```
---

#### 4. Какие типы агрегации интерфейсов есть в Linux? Какие опции есть для балансировки нагрузки? Приведите пример конфига.

Ответ:

Типы агрегации интерфейсов :

+ mode=0 (balance-rr)     Балансировка нагрузки и отказоустойчивость. Пакеты отправляются последовательно, по кругу, с первого по последний интерфейс.
+ mode=1 (active-backup)  Один из интерфейсов активен, остальные в ожидающем. Если активный интерфейс выходит из строя (link down и т.д.), другой интерфейс заменяет активный. Не требует дополнительной настройки коммутатора
+ mode=2 (balance-xor)    Один и тот же интерфейс работает с одним и тем же получателем. Режим даёт балансировку нагрузки и отказоустойчивость. Как только соединение между NIC и соответствующим устройством установлено, тот же NIC будет использоваться для передачи/приема для MAC-адреса назначения, чтобы гарантировать, что MAC-адрес остается тем же.
+ mode=3 (broadcast)      Все пакеты на все интерфейсы. Происходит передача во все объединенные интерфейсы, обеспечивая отказоустойчивость.
+ mode=4 (802.3ad)        Создаются агрегированные группы сетевых карт с одинаковой скоростью и дуплексом.
+ mode=5 (balance-tlb)    Входящие пакеты принимаются только активным сетевым интерфейсом, исходящий распределяется в зависимости от текущей загрузки каждого интерфейса. Не требует настройки коммутатора.
+ mode=6 (balance-alb)    Тоже самое что 5, только входящий трафик тоже распределяется между интерфейсами. Не требует настройки коммутатора, но интерфейсы должны уметь изменять MAC.

Пример конфига (netplan)

```
network:
    version: 2
    renderer: networkd
    ethernets:
        ens2f0: {}
        ens2f1: {}
    bonds:
        bond0:
            dhcp4: no
            interfaces:
            - ens2f0
            - ens2f1
            parameters:
                mode: active-backup
            addresses:
                - 192.168.122.195/24
            gateway4: 192.168.122.1
            mtu: 1500
            nameservers:
                addresses:
                    - 8.8.8.8
                    - 77.88.8.8
```

___

#### 5. Сколько IP адресов в сети с маской /29 ? Сколько /29 подсетей можно получить из сети с маской /24. Приведите несколько примеров /29 подсетей внутри сети 10.10.10.0/24.

Ответ:

>  Сколько IP адресов в сети с маской /29 ? 

Т.к. под адрес машин выделено 3 бита (32-29), 2^3 = 8, значит можно задать 8 IP адресов ( 6, если не учитывать broadcast и адрес сети)

>  Сколько /29 подсетей можно получить из сети с маской /24 

Для разделения сети мы "забираем" 5 бит из машинной части адреса и добавляем её к сетевой части, получается можно создать ещё 2^5 = 32 сети с маской /29  

Примеры:  (ipcalc 10.10.10.0/24 /29)  

```
1.
Network:   10.10.10.0/29        00001010.00001010.00001010.00000 000
HostMin:   10.10.10.1           00001010.00001010.00001010.00000 001
HostMax:   10.10.10.6           00001010.00001010.00001010.00000 110
Broadcast: 10.10.10.7           00001010.00001010.00001010.00000 111
Hosts/Net: 6                     Class A, Private Internet

2.
Network:   10.10.10.8/29        00001010.00001010.00001010.00001 000
HostMin:   10.10.10.9           00001010.00001010.00001010.00001 001
HostMax:   10.10.10.14          00001010.00001010.00001010.00001 110
Broadcast: 10.10.10.15          00001010.00001010.00001010.00001 111
Hosts/Net: 6                     Class A, Private Internet

32.
Network:   10.10.10.248/29      00001010.00001010.00001010.11111 000
HostMin:   10.10.10.249         00001010.00001010.00001010.11111 001
HostMax:   10.10.10.254         00001010.00001010.00001010.11111 110
Broadcast: 10.10.10.255         00001010.00001010.00001010.11111 111
Hosts/Net: 6                     Class A, Private Internet

```
---

#### 6. Задача: вас попросили организовать стык между 2-мя организациями. Диапазоны 10.0.0.0/8, 172.16.0.0/12, 192.168.0.0/16 уже заняты. Из какой подсети допустимо взять частные IP адреса? Маску выберите из расчета максимум 40-50 хостов внутри подсети.

Ответ:  

```
Диапазон: 100.64.0.0 — 100.127.255.255 (маска подсети: 255.192.0.0 или /10)
Подсеть на 62 адреса с маской /26:

Network:   100.64.0.0/26        01100100.01000000.00000000.00 000000
HostMin:   100.64.0.1           01100100.01000000.00000000.00 000001
HostMax:   100.64.0.62          01100100.01000000.00000000.00 111110
Broadcast: 100.64.0.63          01100100.01000000.00000000.00 111111
Hosts/Net: 62                    Class A

````
---

#### 7. Как проверить ARP таблицу в Linux, Windows? Как очистить ARP кеш полностью? Как из ARP таблицы удалить только один нужный IP?

Ответ:

```
ip -c -br n
ip neigh show

очистить  кеш полностью:

sudo ip neigh flush all

удалить конкретную запись:

sudo ip neigh del 192.168.1.100 dev eth0

```
В Windows:

arp -a

Очистить ARP кеш полностью:
netsh interface ip delete arpcache

Удалить конкретный ip :
arp -d 192.168.1.1

---
